D:\Anaconda3\envs\lunarlander\lib\site-packages\pygame\pkgdata.py:25: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import resource_stream, resource_exists
D:\Anaconda3\envs\lunarlander\lib\site-packages\gymnasium\spaces\box.py:235: UserWarning: [33mWARN: Box low's precision lowered by casting to float32, current low.dtype=float64[0m
  gym.logger.warn(
D:\Anaconda3\envs\lunarlander\lib\site-packages\gymnasium\spaces\box.py:305: UserWarning: [33mWARN: Box high's precision lowered by casting to float32, current high.dtype=float64[0m
  gym.logger.warn(
pygame 2.6.1 (SDL 2.28.4, Python 3.9.23)
Hello from the pygame community. https://www.pygame.org/contribute.html
MADDPG训练模式：已禁用可视化渲染以提高训练速度
使用设备: cpu
    [Curriculum] Easy mode: 边界目标主导, 低速目标, 探索奖励增强
--- Episode 1 ---
分配了6个智能体的专责区域
MADDPG初始化完成: 6个智能体
    MADDPG UPDATING at time_step 1000...
    MADDPG UPDATE finished.
    Step 1000, Episode Steps: 1000, Avg Reward: 4.202, Episode Reward: 4202.2
    检测进度: 0/14 (0.0%), Episode total: 1
    智能体位置: [('usv_0', '(300,3152)'), ('usv_1', '(260,4127)'), ('usv_2', '(286,5166)')]...
    Recent rewards sample: {'usv_0': np.float64(2.3903675346331705), 'usv_1': np.float64(1.4698476381188708)}
    Episode time: 100.0s, Time penalty=-0.05
------------------------------------------------------------
    MADDPG UPDATING at time_step 2000...
    MADDPG UPDATE finished.
    Step 2000, Episode Steps: 2000, Avg Reward: 11.732, Episode Reward: 23463.3
    检测进度: 3/39 (7.7%), Episode total: 4
    智能体位置: [('usv_0', '(389,3204)'), ('usv_1', '(271,4085)'), ('usv_2', '(304,5241)')]...
    Recent rewards sample: {'usv_0': np.float64(-2.598372902329934), 'usv_1': np.float64(1.472017875759711)}
    Episode time: 200.0s, Time penalty=-0.05
------------------------------------------------------------
    MADDPG UPDATING at time_step 3000...
    MADDPG UPDATE finished.
    Step 3000, Episode Steps: 3000, Avg Reward: 13.399, Episode Reward: 40198.0
    检测进度: 7/56 (12.5%), Episode total: 8
    智能体位置: [('usv_0', '(400,3297)'), ('usv_1', '(257,4036)'), ('usv_2', '(216,5277)')]...
    Recent rewards sample: {'usv_0': np.float64(2.396522040702961), 'usv_1': np.float64(3.4709083182144944)}
    Episode time: 300.0s, Time penalty=-0.05
------------------------------------------------------------
Episode 1 Summary:
  Total Reward: 40218.7
  Targets Detected: 8/56 (12.5%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 13.40
    [Curriculum] Easy mode: 边界目标主导, 低速目标, 探索奖励增强
--- Episode 2 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 4000...
    MADDPG UPDATE finished.
    Step 4000, Episode Steps: 999, Avg Reward: 6.135, Episode Reward: 6128.9
    检测进度: 2/13 (15.4%), Episode total: 2
    智能体位置: [('usv_0', '(303,3145)'), ('usv_1', '(245,4101)'), ('usv_2', '(270,5174)')]...
    Recent rewards sample: {'usv_0': np.float64(3.3914848318697937), 'usv_1': np.float64(0.47265512103673135)}
    Episode time: 99.9s, Time penalty=-0.05
------------------------------------------------------------
Episode 2 Summary:
  Total Reward: 17517.9
  Targets Detected: 3/20 (10.0%)
  Steps: 1801
  Episode Time: 180.1s
  Termination Reason: no_progress_124s
  Average Reward/Step: 9.73
    [Curriculum] Easy mode: 边界目标主导, 低速目标, 探索奖励增强
--- Episode 3 ---
分配了6个智能体的专责区域
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [0.36400734 0.00635026] (agent usv_0)
    MADDPG UPDATING at time_step 5000...
    MADDPG UPDATE finished.
    Step 5000, Episode Steps: 198, Avg Reward: 7.225, Episode Reward: 1430.6
    检测进度: 1/5 (20.0%), Episode total: 1
    智能体位置: [('usv_0', '(232,3134)'), ('usv_1', '(220,4130)'), ('usv_2', '(233,5132)')]...
    Recent rewards sample: {'usv_0': np.float64(0.3779158715029133), 'usv_1': np.float64(1.4677753973663696)}
    Episode time: 19.8s, Time penalty=-0.05
------------------------------------------------------------
    MADDPG UPDATING at time_step 6000...
    MADDPG UPDATE finished.
    Step 6000, Episode Steps: 1198, Avg Reward: 18.024, Episode Reward: 21592.8
    检测进度: 4/25 (16.0%), Episode total: 5
    智能体位置: [('usv_0', '(324,3183)'), ('usv_1', '(269,4111)'), ('usv_2', '(306,5190)')]...
    Recent rewards sample: {'usv_0': np.float64(2.3947171199482424), 'usv_1': np.float64(3.4706122967886994)}
    Episode time: 119.8s, Time penalty=-0.05
------------------------------------------------------------
Episode 3 Summary:
  Total Reward: 34059.9
  Targets Detected: 5/36 (11.1%)
  Steps: 1866
  Episode Time: 186.6s
  Termination Reason: no_progress_120s
  Average Reward/Step: 18.25
    [Curriculum] Easy mode: 边界目标主导, 低速目标, 探索奖励增强
--- Episode 4 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 7000...
    MADDPG UPDATE finished.
    Step 7000, Episode Steps: 332, Avg Reward: -4.356, Episode Reward: -1446.1
    检测进度: 0/3 (0.0%), Episode total: 0
    智能体位置: [('usv_0', '(250,3129)'), ('usv_1', '(225,4133)'), ('usv_2', '(260,5132)')]...
    Recent rewards sample: {'usv_0': np.float64(-0.6195189702779745), 'usv_1': np.float64(-1.5297365075297882)}
    Episode time: 33.2s, Time penalty=-0.05
------------------------------------------------------------
    MADDPG UPDATING at time_step 8000...
    MADDPG UPDATE finished.
    Step 8000, Episode Steps: 1332, Avg Reward: 0.011, Episode Reward: 14.3
    检测进度: 2/21 (9.5%), Episode total: 2
    智能体位置: [('usv_0', '(345,3170)'), ('usv_1', '(274,4135)'), ('usv_2', '(294,5181)')]...
    Recent rewards sample: {'usv_0': np.float64(1.3921544379211725), 'usv_1': np.float64(0.47678286481547505)}
    Episode time: 133.2s, Time penalty=-0.05
------------------------------------------------------------
    MADDPG UPDATING at time_step 9000...
    MADDPG UPDATE finished.
    Step 9000, Episode Steps: 2332, Avg Reward: 8.086, Episode Reward: 18856.8
    检测进度: 5/33 (15.2%), Episode total: 5
    智能体位置: [('usv_0', '(366,3243)'), ('usv_1', '(317,4113)'), ('usv_2', '(225,5229)')]...
    Recent rewards sample: {'usv_0': np.float64(-0.606939709963909), 'usv_1': np.float64(3.479243198457704)}
    Episode time: 233.2s, Time penalty=-0.05
------------------------------------------------------------
Episode 4 Summary:
  Total Reward: 29303.1
  Targets Detected: 6/45 (8.9%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 9.76
    [Curriculum] Easy mode: 边界目标主导, 低速目标, 探索奖励增强
--- Episode 5 ---
分配了6个智能体的专责区域
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [0.35079371 0.36769132] (agent usv_0)
    MADDPG UPDATING at time_step 10000...
    MADDPG UPDATE finished.
    Step 10000, Episode Steps: 331, Avg Reward: -3.977, Episode Reward: -1316.3
    检测进度: 1/15 (6.7%), Episode total: 1
    智能体位置: [('usv_0', '(252,3128)'), ('usv_1', '(232,4129)'), ('usv_2', '(249,5138)')]...
    Recent rewards sample: {'usv_0': np.float64(-0.61163228751367), 'usv_1': np.float64(-1.524392070088742)}
    Episode time: 33.1s, Time penalty=-0.05
------------------------------------------------------------
    MADDPG UPDATING at time_step 11000...
    MADDPG UPDATE finished.
    Step 11000, Episode Steps: 1331, Avg Reward: 1.869, Episode Reward: 2487.1
    检测进度: 2/27 (7.4%), Episode total: 2
    智能体位置: [('usv_0', '(339,3171)'), ('usv_1', '(285,4109)'), ('usv_2', '(327,5175)')]...
    Recent rewards sample: {'usv_0': np.float64(0.3952697055027383), 'usv_1': np.float64(-0.5272878023478649)}
    Episode time: 133.1s, Time penalty=-0.05
------------------------------------------------------------
    MADDPG UPDATING at time_step 12000...
    MADDPG UPDATE finished.
    Step 12000, Episode Steps: 2331, Avg Reward: 4.068, Episode Reward: 9482.8
    检测进度: 4/39 (10.3%), Episode total: 5
    智能体位置: [('usv_0', '(411,3273)'), ('usv_1', '(304,4066)'), ('usv_2', '(325,5267)')]...
    Recent rewards sample: {'usv_0': np.float64(1.4013824845625686), 'usv_1': np.float64(0.47373090085138303)}
    Episode time: 233.1s, Time penalty=-0.05
------------------------------------------------------------
Episode 5 Summary:
  Total Reward: 18570.2
  Targets Detected: 6/41 (9.8%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 6.19
    [Curriculum] Easy mode: 边界目标主导, 低速目标, 探索奖励增强
--- Episode 6 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 13000...
    MADDPG UPDATE finished.
    Step 13000, Episode Steps: 330, Avg Reward: 5.669, Episode Reward: 1870.9
    检测进度: 1/8 (12.5%), Episode total: 1
    智能体位置: [('usv_0', '(241,3130)'), ('usv_1', '(232,4128)'), ('usv_2', '(257,5144)')]...
    Recent rewards sample: {'usv_0': np.float64(0.37978670181910557), 'usv_1': np.float64(-0.5282523597540214)}
    Episode time: 33.0s, Time penalty=-0.05
------------------------------------------------------------
    MADDPG UPDATING at time_step 14000...
    MADDPG UPDATE finished.
    Step 14000, Episode Steps: 1330, Avg Reward: 9.741, Episode Reward: 12956.2
    检测进度: 2/20 (10.0%), Episode total: 2
    智能体位置: [('usv_0', '(303,3197)'), ('usv_1', '(279,4128)'), ('usv_2', '(345,5211)')]...
    Recent rewards sample: {'usv_0': np.float64(1.3915848007306253), 'usv_1': np.float64(2.4773256020173644)}
    Episode time: 133.0s, Time penalty=-0.05
------------------------------------------------------------
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [0.0147892  0.05715529] (agent usv_0)
    MADDPG UPDATING at time_step 15000...
    MADDPG UPDATE finished.
    Step 15000, Episode Steps: 2330, Avg Reward: 12.467, Episode Reward: 29047.3
    检测进度: 4/30 (13.3%), Episode total: 4
    智能体位置: [('usv_0', '(279,3304)'), ('usv_1', '(329,4137)'), ('usv_2', '(301,5310)')]...
    Recent rewards sample: {'usv_0': np.float64(2.3605826384446473), 'usv_1': np.float64(1.4811102574458652)}
    Episode time: 233.0s, Time penalty=-0.05
------------------------------------------------------------
Episode 6 Summary:
  Total Reward: 40821.8
  Targets Detected: 5/39 (12.8%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 13.60
    [Curriculum] Easy mode: 边界目标主导, 低速目标, 探索奖励增强
--- Episode 7 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 16000...
    MADDPG UPDATE finished.
    Step 16000, Episode Steps: 329, Avg Reward: 9.952, Episode Reward: 3274.1
    检测进度: 2/5 (40.0%), Episode total: 2
    智能体位置: [('usv_0', '(250,3132)'), ('usv_1', '(222,4126)'), ('usv_2', '(230,5138)')]...
    Recent rewards sample: {'usv_0': np.float64(2.37221840411933), 'usv_1': np.float64(3.4753350425321576)}
    Episode time: 32.9s, Time penalty=-0.05
------------------------------------------------------------
    MADDPG UPDATING at time_step 17000...
    MADDPG UPDATE finished.
    Step 17000, Episode Steps: 1329, Avg Reward: 17.068, Episode Reward: 22683.8
    检测进度: 5/24 (20.8%), Episode total: 5
    智能体位置: [('usv_0', '(309,3218)'), ('usv_1', '(258,4103)'), ('usv_2', '(221,5214)')]...
    Recent rewards sample: {'usv_0': np.float64(2.38291766120942), 'usv_1': np.float64(3.4698014280576004)}
    Episode time: 132.9s, Time penalty=-0.05
------------------------------------------------------------
Episode 7 Summary:
  Total Reward: 40705.2
  Targets Detected: 5/37 (13.5%)
  Steps: 2282
  Episode Time: 228.2s
  Termination Reason: no_progress_120s
  Average Reward/Step: 17.84
    [Curriculum] Easy mode: 边界目标主导, 低速目标, 探索奖励增强
--- Episode 8 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 18000...
    MADDPG UPDATE finished.
    Step 18000, Episode Steps: 47, Avg Reward: -2.863, Episode Reward: -134.5
    检测进度: 0/3 (0.0%), Episode total: 0
    智能体位置: [('usv_0', '(214,3130)'), ('usv_1', '(214,4130)'), ('usv_2', '(215,5130)')]...
    Recent rewards sample: {'usv_0': np.float64(-0.6368327610484144), 'usv_1': np.float64(-1.5327123564958174)}
    Episode time: 4.7s, Time penalty=-0.05
------------------------------------------------------------
    MADDPG UPDATING at time_step 19000...
    MADDPG UPDATE finished.
    Step 19000, Episode Steps: 1047, Avg Reward: -2.907, Episode Reward: -3044.0
    检测进度: 1/20 (5.0%), Episode total: 1
    智能体位置: [('usv_0', '(324,3146)'), ('usv_1', '(263,4110)'), ('usv_2', '(288,5193)')]...
    Recent rewards sample: {'usv_0': np.float64(0.3941099549240268), 'usv_1': np.float64(-0.5252626815544365)}
    Episode time: 104.7s, Time penalty=-0.05
------------------------------------------------------------
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [ 0.28590126 -0.04610039] (agent usv_0)
    MADDPG UPDATING at time_step 20000...
    MADDPG UPDATE finished.
    Step 20000, Episode Steps: 2047, Avg Reward: 3.610, Episode Reward: 7389.9
    检测进度: 3/37 (8.1%), Episode total: 3
    智能体位置: [('usv_0', '(423,3168)'), ('usv_1', '(265,4067)'), ('usv_2', '(256,5277)')]...
    Recent rewards sample: {'usv_0': np.float64(2.414099645451799), 'usv_1': np.float64(3.47136173559565)}
    Episode time: 204.7s, Time penalty=-0.05
------------------------------------------------------------
Episode 8 Summary:
  Total Reward: 21003.7
  Targets Detected: 8/57 (10.5%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 7.00
    [Curriculum] Easy mode: 边界目标主导, 低速目标, 探索奖励增强
--- Episode 9 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 21000...
    MADDPG UPDATE finished.
    Step 21000, Episode Steps: 46, Avg Reward: -3.062, Episode Reward: -140.9
    检测进度: 0/1 (0.0%), Episode total: 0
    智能体位置: [('usv_0', '(219,3130)'), ('usv_1', '(214,4130)'), ('usv_2', '(215,5130)')]...
    Recent rewards sample: {'usv_0': np.float64(-0.6356177262423366), 'usv_1': np.float64(-1.5326873213934862)}
    Episode time: 4.6s, Time penalty=-0.05
------------------------------------------------------------
    MADDPG UPDATING at time_step 22000...
    MADDPG UPDATE finished.
    Step 22000, Episode Steps: 1046, Avg Reward: -4.614, Episode Reward: -4826.6
    检测进度: 0/10 (0.0%), Episode total: 0
    智能体位置: [('usv_0', '(301,3170)'), ('usv_1', '(255,4129)'), ('usv_2', '(292,5177)')]...
    Recent rewards sample: {'usv_0': np.float64(-0.6198772460295067), 'usv_1': np.float64(-1.5298359677893898)}
    Episode time: 104.6s, Time penalty=-0.05
------------------------------------------------------------
    MADDPG UPDATING at time_step 23000...
    MADDPG UPDATE finished.
    Step 23000, Episode Steps: 2046, Avg Reward: -0.696, Episode Reward: -1423.0
    检测进度: 2/30 (6.7%), Episode total: 2
    智能体位置: [('usv_0', '(386,3246)'), ('usv_1', '(303,4122)'), ('usv_2', '(299,5251)')]...
    Recent rewards sample: {'usv_0': np.float64(0.4034826327711798), 'usv_1': np.float64(1.4731406806236222)}
    Episode time: 204.6s, Time penalty=-0.05
------------------------------------------------------------
Episode 9 Summary:
  Total Reward: 3583.6
  Targets Detected: 3/39 (5.1%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 1.19
    [Curriculum] Easy mode: 边界目标主导, 低速目标, 探索奖励增强
--- Episode 10 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 24000...
    MADDPG UPDATE finished.
    Step 24000, Episode Steps: 45, Avg Reward: -2.931, Episode Reward: -131.9
    检测进度: 0/4 (0.0%), Episode total: 0
    智能体位置: [('usv_0', '(214,3130)'), ('usv_1', '(213,4130)'), ('usv_2', '(214,5130)')]...
    Recent rewards sample: {'usv_0': np.float64(-0.6369209488596227), 'usv_1': np.float64(-1.5306990503689664)}
    Episode time: 4.5s, Time penalty=-0.05
------------------------------------------------------------
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [0.37280518 0.19608286] (agent usv_0)
    MADDPG UPDATING at time_step 25000...
    MADDPG UPDATE finished.
    Step 25000, Episode Steps: 1045, Avg Reward: 8.054, Episode Reward: 8416.4
    检测进度: 3/16 (18.8%), Episode total: 3
    智能体位置: [('usv_0', '(325,3163)'), ('usv_1', '(266,4120)'), ('usv_2', '(287,5187)')]...
    Recent rewards sample: {'usv_0': np.float64(4.399545370432658), 'usv_1': np.float64(1.4722916667402957)}
    Episode time: 104.5s, Time penalty=-0.05
------------------------------------------------------------
Episode 10 Summary:
  Total Reward: 21045.3
  Targets Detected: 3/31 (9.7%)
  Steps: 1801
  Episode Time: 180.1s
  Termination Reason: no_progress_146s
  Average Reward/Step: 11.69

==================================================
MADDPG TRAINING PROGRESS - Episode 10
==================================================
Last 10 episodes average reward: 26682.9
Last 10 episodes average detections: 5.2
Best episode reward so far: 40821.8
Best detection count so far: 8
Buffer size: 25756
==================================================

    [Curriculum] Medium mode: 目标类型平衡, 速度提升
--- Episode 11 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 26000...
    MADDPG UPDATE finished.
    Step 26000, Episode Steps: 244, Avg Reward: 6.679, Episode Reward: 1629.8
    检测进度: 1/8 (12.5%), Episode total: 1
    智能体位置: [('usv_0', '(236,3130)'), ('usv_1', '(224,4132)'), ('usv_2', '(240,5132)')]...
    Recent rewards sample: {'usv_0': np.float64(2.325757773196103), 'usv_1': np.float64(-0.5799189021267237)}
    Episode time: 24.4s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 27000...
    MADDPG UPDATE finished.
    Step 27000, Episode Steps: 1244, Avg Reward: 13.630, Episode Reward: 16956.3
    检测进度: 2/21 (9.5%), Episode total: 3
    智能体位置: [('usv_0', '(293,3194)'), ('usv_1', '(282,4135)'), ('usv_2', '(326,5214)')]...
    Recent rewards sample: {'usv_0': np.float64(4.3309545078198095), 'usv_1': np.float64(3.423550233228868)}
    Episode time: 124.4s, Time penalty=-0.1
------------------------------------------------------------
Episode 11 Summary:
  Total Reward: 27178.2
  Targets Detected: 3/25 (8.0%)
  Steps: 1801
  Episode Time: 180.1s
  Termination Reason: no_progress_131s
  Average Reward/Step: 15.09
--- Episode 12 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 28000...
    MADDPG UPDATE finished.
    Step 28000, Episode Steps: 443, Avg Reward: -5.020, Episode Reward: -2223.6
    检测进度: 0/15 (0.0%), Episode total: 0
    智能体位置: [('usv_0', '(258,3142)'), ('usv_1', '(243,4128)'), ('usv_2', '(248,5144)')]...
    Recent rewards sample: {'usv_0': np.float64(-0.6694573321592807), 'usv_1': np.float64(-1.5779299190708103)}
    Episode time: 44.3s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 29000...
    MADDPG UPDATE finished.
    Step 29000, Episode Steps: 1443, Avg Reward: -1.128, Episode Reward: -1628.3
    检测进度: 1/32 (3.1%), Episode total: 1
    智能体位置: [('usv_0', '(362,3168)'), ('usv_1', '(278,4088)'), ('usv_2', '(278,5216)')]...
    Recent rewards sample: {'usv_0': np.float64(0.3498838815791817), 'usv_1': np.float64(-0.5785322976113478)}
    Episode time: 144.3s, Time penalty=-0.1
------------------------------------------------------------
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [ 0.02175219 -0.12873885] (agent usv_0)
    MADDPG UPDATING at time_step 30000...
    MADDPG UPDATE finished.
    Step 30000, Episode Steps: 2443, Avg Reward: 2.503, Episode Reward: 6114.3
    检测进度: 4/53 (7.5%), Episode total: 4
    智能体位置: [('usv_0', '(433,3240)'), ('usv_1', '(248,4077)'), ('usv_2', '(223,5296)')]...
    Recent rewards sample: {'usv_0': np.float64(1.3591072864418925), 'usv_1': np.float64(0.4193851757262932)}
    Episode time: 244.3s, Time penalty=-0.1
------------------------------------------------------------
Episode 12 Summary:
  Total Reward: 15484.4
  Targets Detected: 6/60 (10.0%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 5.16
--- Episode 13 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 31000...
    MADDPG UPDATE finished.
    Step 31000, Episode Steps: 442, Avg Reward: -3.948, Episode Reward: -1745.0
    检测进度: 0/10 (0.0%), Episode total: 0
    智能体位置: [('usv_0', '(248,3136)'), ('usv_1', '(251,4131)'), ('usv_2', '(244,5139)')]...
    Recent rewards sample: {'usv_0': np.float64(0.32410881093861055), 'usv_1': np.float64(-0.5778658394008408)}
    Episode time: 44.2s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 32000...
    MADDPG UPDATE finished.
    Step 32000, Episode Steps: 1442, Avg Reward: 5.491, Episode Reward: 7918.3
    检测进度: 2/32 (6.2%), Episode total: 2
    智能体位置: [('usv_0', '(320,3222)'), ('usv_1', '(284,4099)'), ('usv_2', '(289,5214)')]...
    Recent rewards sample: {'usv_0': np.float64(1.3443942372698614), 'usv_1': np.float64(0.42379630579115024)}
    Episode time: 144.2s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 33000...
    MADDPG UPDATE finished.
    Step 33000, Episode Steps: 2442, Avg Reward: 10.533, Episode Reward: 25721.5
    检测进度: 5/61 (8.2%), Episode total: 5
    智能体位置: [('usv_0', '(335,3308)'), ('usv_1', '(264,4060)'), ('usv_2', '(235,5286)')]...
    Recent rewards sample: {'usv_0': np.float64(2.3214754157610518), 'usv_1': np.float64(3.4328536695518297)}
    Episode time: 244.2s, Time penalty=-0.1
------------------------------------------------------------
Episode 13 Summary:
  Total Reward: 31708.5
  Targets Detected: 6/74 (8.1%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 10.57
--- Episode 14 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 34000...
    MADDPG UPDATE finished.
    Step 34000, Episode Steps: 441, Avg Reward: 3.255, Episode Reward: 1435.6
    检测进度: 1/7 (14.3%), Episode total: 1
    智能体位置: [('usv_0', '(248,3144)'), ('usv_1', '(223,4128)'), ('usv_2', '(251,5140)')]...
    Recent rewards sample: {'usv_0': np.float64(0.32370274829097656), 'usv_1': np.float64(-0.5721274918388377)}
    Episode time: 44.1s, Time penalty=-0.1
------------------------------------------------------------
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [ 0.20482505 -0.22979516] (agent usv_0)
    MADDPG UPDATING at time_step 35000...
    MADDPG UPDATE finished.
    Step 35000, Episode Steps: 1441, Avg Reward: 7.953, Episode Reward: 11460.3
    检测进度: 4/35 (11.4%), Episode total: 4
    智能体位置: [('usv_0', '(297,3227)'), ('usv_1', '(246,4093)'), ('usv_2', '(288,5196)')]...
    Recent rewards sample: {'usv_0': np.float64(2.3299098697269995), 'usv_1': np.float64(1.4200160574427008)}
    Episode time: 144.1s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 36000...
    MADDPG UPDATE finished.
    Step 36000, Episode Steps: 2441, Avg Reward: 12.807, Episode Reward: 31261.9
    检测进度: 6/54 (11.1%), Episode total: 7
    智能体位置: [('usv_0', '(302,3336)'), ('usv_1', '(228,4061)'), ('usv_2', '(229,5266)')]...
    Recent rewards sample: {'usv_0': np.float64(2.310284754201759), 'usv_1': np.float64(1.418193500661621)}
    Episode time: 244.1s, Time penalty=-0.1
------------------------------------------------------------
Episode 14 Summary:
  Total Reward: 35943.2
  Targets Detected: 8/72 (8.3%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 11.98
--- Episode 15 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 37000...
    MADDPG UPDATE finished.
    Step 37000, Episode Steps: 440, Avg Reward: -5.093, Episode Reward: -2241.1
    检测进度: 0/8 (0.0%), Episode total: 0
    智能体位置: [('usv_0', '(259,3144)'), ('usv_1', '(238,4120)'), ('usv_2', '(240,5137)')]...
    Recent rewards sample: {'usv_0': np.float64(-0.665074394658179), 'usv_1': np.float64(-1.574795507429463)}
    Episode time: 44.0s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 38000...
    MADDPG UPDATE finished.
    Step 38000, Episode Steps: 1440, Avg Reward: 1.575, Episode Reward: 2267.8
    检测进度: 2/28 (7.1%), Episode total: 2
    智能体位置: [('usv_0', '(307,3236)'), ('usv_1', '(269,4098)'), ('usv_2', '(260,5228)')]...
    Recent rewards sample: {'usv_0': np.float64(2.338004183310444), 'usv_1': np.float64(1.424492049885127)}
    Episode time: 144.0s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 39000...
    MADDPG UPDATE finished.
    Step 39000, Episode Steps: 2440, Avg Reward: 5.093, Episode Reward: 12425.9
    检测进度: 3/52 (5.8%), Episode total: 3
    智能体位置: [('usv_0', '(265,3299)'), ('usv_1', '(278,4053)'), ('usv_2', '(210,5307)')]...
    Recent rewards sample: {'usv_0': np.float64(2.3070786204300058), 'usv_1': np.float64(3.427043416041762)}
    Episode time: 244.0s, Time penalty=-0.1
------------------------------------------------------------
Episode 15 Summary:
  Total Reward: 16889.7
  Targets Detected: 3/58 (5.2%)
  Steps: 2693
  Episode Time: 269.3s
  Termination Reason: no_progress_120s
  Average Reward/Step: 6.27
--- Episode 16 ---
分配了6个智能体的专责区域
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [ 0.10418445 -0.03755018] (agent usv_0)
    MADDPG UPDATING at time_step 40000...
    MADDPG UPDATE finished.
    Step 40000, Episode Steps: 747, Avg Reward: 13.793, Episode Reward: 10303.5
    检测进度: 2/20 (10.0%), Episode total: 2
    智能体位置: [('usv_0', '(288,3131)'), ('usv_1', '(232,4120)'), ('usv_2', '(260,5155)')]...
    Recent rewards sample: {'usv_0': np.float64(4.333230054155756), 'usv_1': np.float64(1.4177633824896945)}
    Episode time: 74.7s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 41000...
    MADDPG UPDATE finished.
    Step 41000, Episode Steps: 1747, Avg Reward: 18.323, Episode Reward: 32009.5
    检测进度: 6/35 (17.1%), Episode total: 7
    智能体位置: [('usv_0', '(364,3184)'), ('usv_1', '(229,4061)'), ('usv_2', '(292,5235)')]...
    Recent rewards sample: {'usv_0': np.float64(4.347526057995587), 'usv_1': np.float64(1.4183041998249246)}
    Episode time: 174.7s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 42000...
    MADDPG UPDATE finished.
    Step 42000, Episode Steps: 2747, Avg Reward: 18.303, Episode Reward: 50277.1
    检测进度: 7/51 (13.7%), Episode total: 8
    智能体位置: [('usv_0', '(391,3277)'), ('usv_1', '(249,4013)'), ('usv_2', '(221,5285)')]...
    Recent rewards sample: {'usv_0': np.float64(4.345316916825881), 'usv_1': np.float64(1.4224642574555597)}
    Episode time: 274.7s, Time penalty=-0.1
------------------------------------------------------------
Episode 16 Summary:
  Total Reward: 54945.5
  Targets Detected: 8/54 (11.1%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 18.31
--- Episode 17 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 43000...
    MADDPG UPDATE finished.
    Step 43000, Episode Steps: 746, Avg Reward: -4.688, Episode Reward: -3497.3
    检测进度: 0/12 (0.0%), Episode total: 0
    智能体位置: [('usv_0', '(280,3148)'), ('usv_1', '(242,4109)'), ('usv_2', '(282,5150)')]...
    Recent rewards sample: {'usv_0': np.float64(-0.6691370706641148), 'usv_1': np.float64(-1.5814865128608848)}
    Episode time: 74.6s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 44000...
    MADDPG UPDATE finished.
    Step 44000, Episode Steps: 1746, Avg Reward: 2.237, Episode Reward: 3906.2
    检测进度: 4/39 (10.3%), Episode total: 4
    智能体位置: [('usv_0', '(340,3232)'), ('usv_1', '(257,4064)'), ('usv_2', '(294,5232)')]...
    Recent rewards sample: {'usv_0': np.float64(4.340988973568334), 'usv_1': np.float64(3.4233379757271756)}
    Episode time: 174.6s, Time penalty=-0.1
------------------------------------------------------------
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [ 0.17519232 -0.13864233] (agent usv_0)
    MADDPG UPDATING at time_step 45000...
    MADDPG UPDATE finished.
    Step 45000, Episode Steps: 2746, Avg Reward: 7.983, Episode Reward: 21921.5
    检测进度: 4/65 (6.2%), Episode total: 5
    智能体位置: [('usv_0', '(338,3341)'), ('usv_1', '(248,4024)'), ('usv_2', '(216,5263)')]...
    Recent rewards sample: {'usv_0': np.float64(4.3207237360811765), 'usv_1': np.float64(1.4226367444616739)}
    Episode time: 274.6s, Time penalty=-0.1
------------------------------------------------------------
Episode 17 Summary:
  Total Reward: 26373.8
  Targets Detected: 5/72 (5.6%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 8.79
--- Episode 18 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 46000...
    MADDPG UPDATE finished.
    Step 46000, Episode Steps: 745, Avg Reward: -3.682, Episode Reward: -2743.4
    检测进度: 1/13 (7.7%), Episode total: 1
    智能体位置: [('usv_0', '(281,3150)'), ('usv_1', '(239,4117)'), ('usv_2', '(276,5150)')]...
    Recent rewards sample: {'usv_0': np.float64(-0.6650947926060358), 'usv_1': np.float64(-1.5767561425644392)}
    Episode time: 74.5s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 47000...
    MADDPG UPDATE finished.
    Step 47000, Episode Steps: 1745, Avg Reward: -1.190, Episode Reward: -2075.9
    检测进度: 3/36 (8.3%), Episode total: 3
    智能体位置: [('usv_0', '(333,3255)'), ('usv_1', '(280,4093)'), ('usv_2', '(335,5212)')]...
    Recent rewards sample: {'usv_0': np.float64(-6.665633896077026), 'usv_1': np.float64(2.423386578736203)}
    Episode time: 174.5s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 48000...
    MADDPG UPDATE finished.
    Step 48000, Episode Steps: 2745, Avg Reward: -1.735, Episode Reward: -4761.2
    检测进度: 3/53 (5.7%), Episode total: 3
    智能体位置: [('usv_0', '(346,3376)'), ('usv_1', '(292,4061)'), ('usv_2', '(285,5282)')]...
    Recent rewards sample: {'usv_0': np.float64(1.3213232602548979), 'usv_1': np.float64(2.42287944112511)}
    Episode time: 274.5s, Time penalty=-0.1
------------------------------------------------------------
Episode 18 Summary:
  Total Reward: -2715.0
  Targets Detected: 3/56 (5.4%)
  Steps: 2911
  Episode Time: 291.1s
  Termination Reason: no_progress_120s
  Average Reward/Step: -0.93
--- Episode 19 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 49000...
    MADDPG UPDATE finished.
    Step 49000, Episode Steps: 834, Avg Reward: -3.608, Episode Reward: -3009.0
    检测进度: 0/15 (0.0%), Episode total: 0
    智能体位置: [('usv_0', '(294,3134)'), ('usv_1', '(242,4092)'), ('usv_2', '(307,5167)')]...
    Recent rewards sample: {'usv_0': np.float64(-0.6647096240698456), 'usv_1': np.float64(-1.5788299769097907)}
    Episode time: 83.4s, Time penalty=-0.1
------------------------------------------------------------
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [0.16547883 0.0244958 ] (agent usv_0)
    MADDPG UPDATING at time_step 50000...
    MADDPG UPDATE finished.
    Step 50000, Episode Steps: 1834, Avg Reward: -0.564, Episode Reward: -1035.2
    检测进度: 1/27 (3.7%), Episode total: 1
    智能体位置: [('usv_0', '(362,3207)'), ('usv_1', '(252,4042)'), ('usv_2', '(332,5256)')]...
    Recent rewards sample: {'usv_0': np.float64(-7.651174338779518), 'usv_1': np.float64(1.4213649596573745)}
    Episode time: 183.4s, Time penalty=-0.1
------------------------------------------------------------
Episode 19 Summary:
  Total Reward: -8422.3
  Targets Detected: 1/46 (2.2%)
  Steps: 2538
  Episode Time: 253.8s
  Termination Reason: no_progress_120s
  Average Reward/Step: -3.32
--- Episode 20 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 51000...
    MADDPG UPDATE finished.
    Step 51000, Episode Steps: 296, Avg Reward: -4.090, Episode Reward: -1210.7
    检测进度: 0/7 (0.0%), Episode total: 0
    智能体位置: [('usv_0', '(251,3135)'), ('usv_1', '(222,4126)'), ('usv_2', '(240,5139)')]...
    Recent rewards sample: {'usv_0': np.float64(-0.6764302461117518), 'usv_1': np.float64(-1.5820260974785367)}
    Episode time: 29.6s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 52000...
    MADDPG UPDATE finished.
    Step 52000, Episode Steps: 1296, Avg Reward: -2.833, Episode Reward: -3671.3
    检测进度: 1/28 (3.6%), Episode total: 1
    智能体位置: [('usv_0', '(327,3207)'), ('usv_1', '(253,4108)'), ('usv_2', '(311,5221)')]...
    Recent rewards sample: {'usv_0': np.float64(1.331856380434905), 'usv_1': np.float64(2.420480576215815)}
    Episode time: 129.6s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 53000...
    MADDPG UPDATE finished.
    Step 53000, Episode Steps: 2296, Avg Reward: 2.385, Episode Reward: 5475.8
    检测进度: 3/60 (5.0%), Episode total: 3
    智能体位置: [('usv_0', '(332,3288)'), ('usv_1', '(262,4071)'), ('usv_2', '(337,5331)')]...
    Recent rewards sample: {'usv_0': np.float64(2.3279305065259877), 'usv_1': np.float64(3.42148006928306)}
    Episode time: 229.6s, Time penalty=-0.1
------------------------------------------------------------
Episode 20 Summary:
  Total Reward: 17439.0
  Targets Detected: 5/80 (5.0%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 5.81

==================================================
MADDPG TRAINING PROGRESS - Episode 20
==================================================
Last 10 episodes average reward: 21482.5
Last 10 episodes average detections: 4.8
Best episode reward so far: 54945.5
Best detection count so far: 8
Learning trend: Declining (21482.5 vs 26682.9)
Buffer size: 50000
==================================================

--- Episode 21 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 54000...
    MADDPG UPDATE finished.
    Step 54000, Episode Steps: 295, Avg Reward: -4.183, Episode Reward: -1233.9
    检测进度: 0/6 (0.0%), Episode total: 0
    智能体位置: [('usv_0', '(228,3129)'), ('usv_1', '(219,4130)'), ('usv_2', '(235,5132)')]...
    Recent rewards sample: {'usv_0': np.float64(-0.683160778737325), 'usv_1': np.float64(-1.5803104196369568)}
    Episode time: 29.5s, Time penalty=-0.1
------------------------------------------------------------
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [ 0.08353798 -0.07230935] (agent usv_0)
    MADDPG UPDATING at time_step 55000...
    MADDPG UPDATE finished.
    Step 55000, Episode Steps: 1295, Avg Reward: -1.146, Episode Reward: -1484.4
    检测进度: 3/28 (10.7%), Episode total: 3
    智能体位置: [('usv_0', '(311,3192)'), ('usv_1', '(263,4111)'), ('usv_2', '(322,5190)')]...
    Recent rewards sample: {'usv_0': np.float64(1.3340055406946187), 'usv_1': np.float64(0.42015793228674014)}
    Episode time: 129.5s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 56000...
    MADDPG UPDATE finished.
    Step 56000, Episode Steps: 2295, Avg Reward: 1.705, Episode Reward: 3913.2
    检测进度: 4/51 (7.8%), Episode total: 4
    智能体位置: [('usv_0', '(314,3292)'), ('usv_1', '(307,4148)'), ('usv_2', '(330,5289)')]...
    Recent rewards sample: {'usv_0': np.float64(-5.681703656356453), 'usv_1': np.float64(1.4235061994240574)}
    Episode time: 229.5s, Time penalty=-0.1
------------------------------------------------------------
Episode 21 Summary:
  Total Reward: 6318.7
  Targets Detected: 6/69 (5.8%)
  Steps: 2989
  Episode Time: 298.9s
  Termination Reason: no_progress_120s
  Average Reward/Step: 2.11
--- Episode 22 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 57000...
    MADDPG UPDATE finished.
    Step 57000, Episode Steps: 306, Avg Reward: 5.682, Episode Reward: 1738.8
    检测进度: 1/5 (20.0%), Episode total: 1
    智能体位置: [('usv_0', '(242,3135)'), ('usv_1', '(223,4126)'), ('usv_2', '(237,5134)')]...
    Recent rewards sample: {'usv_0': np.float64(2.3228170748791266), 'usv_1': np.float64(-0.5829688030385978)}
    Episode time: 30.6s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 58000...
    MADDPG UPDATE finished.
    Step 58000, Episode Steps: 1306, Avg Reward: 4.411, Episode Reward: 5761.3
    检测进度: 2/33 (6.1%), Episode total: 2
    智能体位置: [('usv_0', '(351,3171)'), ('usv_1', '(253,4108)'), ('usv_2', '(313,5209)')]...
    Recent rewards sample: {'usv_0': np.float64(3.355425295309754), 'usv_1': np.float64(0.4193613874161741)}
    Episode time: 130.6s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 59000...
    MADDPG UPDATE finished.
    Step 59000, Episode Steps: 2306, Avg Reward: 6.975, Episode Reward: 16084.5
    检测进度: 2/38 (5.3%), Episode total: 2
    智能体位置: [('usv_0', '(395,3252)'), ('usv_1', '(296,4087)'), ('usv_2', '(282,5298)')]...
    Recent rewards sample: {'usv_0': np.float64(1.3449306775167758), 'usv_1': np.float64(2.422881231980054)}
    Episode time: 230.6s, Time penalty=-0.1
------------------------------------------------------------
Episode 22 Summary:
  Total Reward: 16880.3
  Targets Detected: 2/39 (5.1%)
  Steps: 2383
  Episode Time: 238.3s
  Termination Reason: no_progress_120s
  Average Reward/Step: 7.08
--- Episode 23 ---
分配了6个智能体的专责区域
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [0.09576058 0.18473434] (agent usv_0)
    MADDPG UPDATING at time_step 60000...
    MADDPG UPDATE finished.
    Step 60000, Episode Steps: 923, Avg Reward: 5.671, Episode Reward: 5234.0
    检测进度: 2/18 (11.1%), Episode total: 2
    智能体位置: [('usv_0', '(320,3144)'), ('usv_1', '(258,4118)'), ('usv_2', '(271,5188)')]...
    Recent rewards sample: {'usv_0': np.float64(1.3433138930942534), 'usv_1': np.float64(0.41974870352777494)}
    Episode time: 92.3s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 61000...
    MADDPG UPDATE finished.
    Step 61000, Episode Steps: 1923, Avg Reward: 12.309, Episode Reward: 23669.8
    检测进度: 5/39 (12.8%), Episode total: 5
    智能体位置: [('usv_0', '(426,3154)'), ('usv_1', '(241,4089)'), ('usv_2', '(245,5257)')]...
    Recent rewards sample: {'usv_0': np.float64(4.367828123608865), 'usv_1': np.float64(1.4186262347621081)}
    Episode time: 192.3s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 62000...
    MADDPG UPDATE finished.
    Step 62000, Episode Steps: 2923, Avg Reward: 14.770, Episode Reward: 43171.9
    检测进度: 8/57 (14.0%), Episode total: 8
    智能体位置: [('usv_0', '(469,3217)'), ('usv_1', '(208,4062)'), ('usv_2', '(202,5258)')]...
    Recent rewards sample: {'usv_0': np.float64(4.367718884754499), 'usv_1': np.float64(3.421524786713995)}
    Episode time: 292.3s, Time penalty=-0.1
------------------------------------------------------------
Episode 23 Summary:
  Total Reward: 46993.3
  Targets Detected: 10/63 (15.9%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 15.66
--- Episode 24 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 63000...
    MADDPG UPDATE finished.
    Step 63000, Episode Steps: 922, Avg Reward: 6.181, Episode Reward: 5699.1
    检测进度: 1/29 (3.4%), Episode total: 2
    智能体位置: [('usv_0', '(289,3150)'), ('usv_1', '(250,4138)'), ('usv_2', '(282,5154)')]...
    Recent rewards sample: {'usv_0': np.float64(1.3348150689910796), 'usv_1': np.float64(0.4191094801261488)}
    Episode time: 92.2s, Time penalty=-0.1
------------------------------------------------------------
Episode 24 Summary:
  Total Reward: 19911.4
  Targets Detected: 3/47 (4.3%)
  Steps: 1801
  Episode Time: 180.1s
  Termination Reason: no_progress_123s
  Average Reward/Step: 11.06
--- Episode 25 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 64000...
    MADDPG UPDATE finished.
    Step 64000, Episode Steps: 121, Avg Reward: -4.490, Episode Reward: -543.2
    检测进度: 0/6 (0.0%), Episode total: 0
    智能体位置: [('usv_0', '(221,3131)'), ('usv_1', '(217,4130)'), ('usv_2', '(220,5132)')]...
    Recent rewards sample: {'usv_0': np.float64(-0.6833537779790941), 'usv_1': np.float64(-1.5793945968855316)}
    Episode time: 12.1s, Time penalty=-0.1
------------------------------------------------------------
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [-0.14629496  0.19912084] (agent usv_0)
    MADDPG UPDATING at time_step 65000...
    MADDPG UPDATE finished.
    Step 65000, Episode Steps: 1121, Avg Reward: 9.449, Episode Reward: 10592.7
    检测进度: 4/33 (12.1%), Episode total: 4
    智能体位置: [('usv_0', '(302,3163)'), ('usv_1', '(269,4138)'), ('usv_2', '(242,5197)')]...
    Recent rewards sample: {'usv_0': np.float64(4.333140242964702), 'usv_1': np.float64(3.4205158098501593)}
    Episode time: 112.1s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 66000...
    MADDPG UPDATE finished.
    Step 66000, Episode Steps: 2121, Avg Reward: 13.731, Episode Reward: 29124.1
    检测进度: 5/47 (10.6%), Episode total: 5
    智能体位置: [('usv_0', '(394,3198)'), ('usv_1', '(313,4132)'), ('usv_2', '(208,5230)')]...
    Recent rewards sample: {'usv_0': np.float64(2.358862944350801), 'usv_1': np.float64(3.429427592092342)}
    Episode time: 212.1s, Time penalty=-0.1
------------------------------------------------------------
Episode 25 Summary:
  Total Reward: 46864.8
  Targets Detected: 9/68 (13.2%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 15.62
--- Episode 26 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 67000...
    MADDPG UPDATE finished.
    Step 67000, Episode Steps: 120, Avg Reward: -4.186, Episode Reward: -502.3
    检测进度: 0/2 (0.0%), Episode total: 0
    智能体位置: [('usv_0', '(223,3130)'), ('usv_1', '(215,4130)'), ('usv_2', '(225,5131)')]...
    Recent rewards sample: {'usv_0': np.float64(-0.6798682064199897), 'usv_1': np.float64(-1.5815402677075894)}
    Episode time: 12.0s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 68000...
    MADDPG UPDATE finished.
    Step 68000, Episode Steps: 1120, Avg Reward: -0.736, Episode Reward: -824.6
    检测进度: 2/23 (8.7%), Episode total: 2
    智能体位置: [('usv_0', '(342,3152)'), ('usv_1', '(261,4122)'), ('usv_2', '(304,5190)')]...
    Recent rewards sample: {'usv_0': np.float64(3.3428486737481498), 'usv_1': np.float64(2.4254643406716268)}
    Episode time: 112.0s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 69000...
    MADDPG UPDATE finished.
    Step 69000, Episode Steps: 2120, Avg Reward: 4.247, Episode Reward: 9003.5
    检测进度: 2/47 (4.3%), Episode total: 2
    智能体位置: [('usv_0', '(352,3252)'), ('usv_1', '(312,4101)'), ('usv_2', '(290,5253)')]...
    Recent rewards sample: {'usv_0': np.float64(-4.658949210813546), 'usv_1': np.float64(2.429811189208008)}
    Episode time: 212.0s, Time penalty=-0.1
------------------------------------------------------------
Episode 26 Summary:
  Total Reward: 8580.9
  Targets Detected: 2/50 (4.0%)
  Steps: 2237
  Episode Time: 223.7s
  Termination Reason: no_progress_120s
  Average Reward/Step: 3.84
--- Episode 27 ---
分配了6个智能体的专责区域
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [ 0.38242529 -0.08026343] (agent usv_0)
    MADDPG UPDATING at time_step 70000...
    MADDPG UPDATE finished.
    Step 70000, Episode Steps: 883, Avg Reward: 1.768, Episode Reward: 1561.4
    检测进度: 1/23 (4.3%), Episode total: 1
    智能体位置: [('usv_0', '(300,3166)'), ('usv_1', '(241,4124)'), ('usv_2', '(287,5173)')]...
    Recent rewards sample: {'usv_0': np.float64(0.3435264496042041), 'usv_1': np.float64(-0.5805691299514606)}
    Episode time: 88.3s, Time penalty=-0.1
------------------------------------------------------------
Episode 27 Summary:
  Total Reward: 3255.4
  Targets Detected: 1/38 (0.0%)
  Steps: 1801
  Episode Time: 180.1s
  Termination Reason: no_progress_164s
  Average Reward/Step: 1.81
--- Episode 28 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 71000...
    MADDPG UPDATE finished.
    Step 71000, Episode Steps: 82, Avg Reward: -4.546, Episode Reward: -372.8
    检测进度: 0/3 (0.0%), Episode total: 0
    智能体位置: [('usv_0', '(219,3130)'), ('usv_1', '(219,4130)'), ('usv_2', '(219,5130)')]...
    Recent rewards sample: {'usv_0': np.float64(-0.6840392948351559), 'usv_1': np.float64(-1.5832607615300764)}
    Episode time: 8.2s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 72000...
    MADDPG UPDATE finished.
    Step 72000, Episode Steps: 1082, Avg Reward: 10.365, Episode Reward: 11214.5
    检测进度: 3/22 (13.6%), Episode total: 3
    智能体位置: [('usv_0', '(327,3141)'), ('usv_1', '(259,4117)'), ('usv_2', '(235,5173)')]...
    Recent rewards sample: {'usv_0': np.float64(2.3437967988219763), 'usv_1': np.float64(1.4238354658412478)}
    Episode time: 108.2s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 73000...
    MADDPG UPDATE finished.
    Step 73000, Episode Steps: 2082, Avg Reward: 14.472, Episode Reward: 30130.6
    检测进度: 7/50 (14.0%), Episode total: 7
    智能体位置: [('usv_0', '(417,3206)'), ('usv_1', '(277,4081)'), ('usv_2', '(206,5147)')]...
    Recent rewards sample: {'usv_0': np.float64(4.355197765738347), 'usv_1': np.float64(1.4254400870474488)}
    Episode time: 208.2s, Time penalty=-0.1
------------------------------------------------------------
Episode 28 Summary:
  Total Reward: 48652.5
  Targets Detected: 9/62 (14.5%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 16.21
--- Episode 29 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 74000...
    MADDPG UPDATE finished.
    Step 74000, Episode Steps: 81, Avg Reward: -0.245, Episode Reward: -19.9
    检测进度: 0/8 (0.0%), Episode total: 0
    智能体位置: [('usv_0', '(220,3130)'), ('usv_1', '(224,4130)'), ('usv_2', '(218,5130)')]...
    Recent rewards sample: {'usv_0': np.float64(0.3197814298540932), 'usv_1': np.float64(-0.5790674150925876)}
    Episode time: 8.1s, Time penalty=-0.1
------------------------------------------------------------
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [0.08814098 0.06560962] (agent usv_0)
    MADDPG UPDATING at time_step 75000...
    MADDPG UPDATE finished.
    Step 75000, Episode Steps: 1081, Avg Reward: 16.617, Episode Reward: 17962.7
    检测进度: 4/27 (14.8%), Episode total: 4
    智能体位置: [('usv_0', '(317,3142)'), ('usv_1', '(271,4117)'), ('usv_2', '(282,5155)')]...
    Recent rewards sample: {'usv_0': np.float64(4.340071573360329), 'usv_1': np.float64(1.421743866189101)}
    Episode time: 108.1s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 76000...
    MADDPG UPDATE finished.
    Step 76000, Episode Steps: 2081, Avg Reward: 17.407, Episode Reward: 36223.5
    检测进度: 4/51 (7.8%), Episode total: 4
    智能体位置: [('usv_0', '(407,3214)'), ('usv_1', '(321,4109)'), ('usv_2', '(351,5233)')]...
    Recent rewards sample: {'usv_0': np.float64(4.359058782143636), 'usv_1': np.float64(1.4302954464782869)}
    Episode time: 208.1s, Time penalty=-0.1
------------------------------------------------------------
Episode 29 Summary:
  Total Reward: 39816.4
  Targets Detected: 4/56 (7.1%)
  Steps: 2277
  Episode Time: 227.7s
  Termination Reason: no_progress_120s
  Average Reward/Step: 17.49
--- Episode 30 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 77000...
    MADDPG UPDATE finished.
    Step 77000, Episode Steps: 804, Avg Reward: 3.209, Episode Reward: 2579.8
    检测进度: 2/16 (12.5%), Episode total: 2
    智能体位置: [('usv_0', '(284,3143)'), ('usv_1', '(246,4112)'), ('usv_2', '(279,5173)')]...
    Recent rewards sample: {'usv_0': np.float64(3.335145673373609), 'usv_1': np.float64(2.4192004393481508)}
    Episode time: 80.4s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 78000...
    MADDPG UPDATE finished.
    Step 78000, Episode Steps: 1804, Avg Reward: 11.558, Episode Reward: 20850.6
    检测进度: 4/45 (8.9%), Episode total: 5
    智能体位置: [('usv_0', '(305,3214)'), ('usv_1', '(220,4071)'), ('usv_2', '(264,5255)')]...
    Recent rewards sample: {'usv_0': np.float64(4.325427838577205), 'usv_1': np.float64(3.4231536556884743)}
    Episode time: 180.4s, Time penalty=-0.1
------------------------------------------------------------
    MADDPG UPDATING at time_step 79000...
    MADDPG UPDATE finished.
    Step 79000, Episode Steps: 2804, Avg Reward: 14.743, Episode Reward: 41339.0
    检测进度: 6/78 (7.7%), Episode total: 8
    智能体位置: [('usv_0', '(251,3290)'), ('usv_1', '(205,4061)'), ('usv_2', '(205,5256)')]...
    Recent rewards sample: {'usv_0': np.float64(2.3052675842274386), 'usv_1': np.float64(3.418526686957305)}
    Episode time: 280.4s, Time penalty=-0.1
------------------------------------------------------------
Episode 30 Summary:
  Total Reward: 44890.8
  Targets Detected: 8/82 (7.3%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 14.96

==================================================
MADDPG TRAINING PROGRESS - Episode 30
==================================================
Last 10 episodes average reward: 28216.4
Last 10 episodes average detections: 5.4
Best episode reward so far: 54945.5
Best detection count so far: 10
Learning trend: Improving (28216.4 vs 21482.5)
Buffer size: 50000
==================================================

    [Curriculum] Hard mode: 高速目标主导, 效率优先
--- Episode 31 ---
分配了6个智能体的专责区域
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [0.14190081 0.16179394] (agent usv_0)
    MADDPG UPDATING at time_step 80000...
    MADDPG UPDATE finished.
    Step 80000, Episode Steps: 803, Avg Reward: 6.324, Episode Reward: 5078.5
    检测进度: 2/24 (8.3%), Episode total: 2
    智能体位置: [('usv_0', '(293,3147)'), ('usv_1', '(253,4112)'), ('usv_2', '(277,5175)')]...
    Recent rewards sample: {'usv_0': np.float64(3.2883489342960392), 'usv_1': np.float64(0.37234791351706686)}
    Episode time: 80.3s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 81000...
    MADDPG UPDATE finished.
    Step 81000, Episode Steps: 1803, Avg Reward: 15.605, Episode Reward: 28135.6
    检测进度: 5/65 (7.7%), Episode total: 6
    智能体位置: [('usv_0', '(345,3223)'), ('usv_1', '(286,4079)'), ('usv_2', '(285,5261)')]...
    Recent rewards sample: {'usv_0': np.float64(4.285186789658974), 'usv_1': np.float64(3.375352788449505)}
    Episode time: 180.3s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 82000...
    MADDPG UPDATE finished.
    Step 82000, Episode Steps: 2803, Avg Reward: 12.729, Episode Reward: 35678.1
    检测进度: 13/90 (14.4%), Episode total: 15
    智能体位置: [('usv_0', '(298,3306)'), ('usv_1', '(285,4045)'), ('usv_2', '(207,5268)')]...
    Recent rewards sample: {'usv_0': np.float64(-5.720090937883443), 'usv_1': np.float64(3.3808010407384996)}
    Episode time: 280.3s, Time penalty=-0.15
------------------------------------------------------------
Episode 31 Summary:
  Total Reward: 35659.5
  Targets Detected: 15/93 (14.0%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 11.88
--- Episode 32 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 83000...
    MADDPG UPDATE finished.
    Step 83000, Episode Steps: 802, Avg Reward: -3.867, Episode Reward: -3101.5
    检测进度: 1/18 (5.6%), Episode total: 1
    智能体位置: [('usv_0', '(321,3174)'), ('usv_1', '(232,4117)'), ('usv_2', '(272,5143)')]...
    Recent rewards sample: {'usv_0': np.float64(-0.7112551575730435), 'usv_1': np.float64(-1.6322521977359448)}
    Episode time: 80.2s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 84000...
    MADDPG UPDATE finished.
    Step 84000, Episode Steps: 1802, Avg Reward: -3.400, Episode Reward: -6126.1
    检测进度: 2/41 (4.9%), Episode total: 3
    智能体位置: [('usv_0', '(381,3251)'), ('usv_1', '(241,4074)'), ('usv_2', '(286,5214)')]...
    Recent rewards sample: {'usv_0': np.float64(0.2915023860225787), 'usv_1': np.float64(1.3710165391267193)}
    Episode time: 180.2s, Time penalty=-0.15
------------------------------------------------------------
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [0.22366556 0.10567243] (agent usv_0)
    MADDPG UPDATING at time_step 85000...
    MADDPG UPDATE finished.
    Step 85000, Episode Steps: 2802, Avg Reward: -2.408, Episode Reward: -6747.5
    检测进度: 3/71 (4.2%), Episode total: 4
    智能体位置: [('usv_0', '(395,3357)'), ('usv_1', '(209,4039)'), ('usv_2', '(202,5193)')]...
    Recent rewards sample: {'usv_0': np.float64(2.2877178628043184), 'usv_1': np.float64(3.3674187523607007)}
    Episode time: 280.2s, Time penalty=-0.15
------------------------------------------------------------
Episode 32 Summary:
  Total Reward: -3161.2
  Targets Detected: 4/83 (3.6%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: -1.05
--- Episode 33 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 86000...
    MADDPG UPDATE finished.
    Step 86000, Episode Steps: 801, Avg Reward: -5.278, Episode Reward: -4227.9
    检测进度: 0/29 (0.0%), Episode total: 0
    智能体位置: [('usv_0', '(283,3145)'), ('usv_1', '(243,4105)'), ('usv_2', '(263,5167)')]...
    Recent rewards sample: {'usv_0': np.float64(-0.7100356323166829), 'usv_1': np.float64(-1.6238511168281298)}
    Episode time: 80.1s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 87000...
    MADDPG UPDATE finished.
    Step 87000, Episode Steps: 1801, Avg Reward: -2.322, Episode Reward: -4181.1
    检测进度: 2/64 (3.1%), Episode total: 2
    智能体位置: [('usv_0', '(350,3226)'), ('usv_1', '(273,4070)'), ('usv_2', '(212,5238)')]...
    Recent rewards sample: {'usv_0': np.float64(-8.708880163623046), 'usv_1': np.float64(0.3724075563931799)}
    Episode time: 180.1s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 88000...
    MADDPG UPDATE finished.
    Step 88000, Episode Steps: 2801, Avg Reward: 0.756, Episode Reward: 2117.3
    检测进度: 8/101 (7.9%), Episode total: 9
    智能体位置: [('usv_0', '(301,3302)'), ('usv_1', '(274,4027)'), ('usv_2', '(201,5191)')]...
    Recent rewards sample: {'usv_0': np.float64(-6.7304545504116735), 'usv_1': np.float64(3.3733027330796546)}
    Episode time: 280.1s, Time penalty=-0.15
------------------------------------------------------------
Episode 33 Summary:
  Total Reward: 4764.4
  Targets Detected: 11/106 (8.5%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 1.59
--- Episode 34 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 89000...
    MADDPG UPDATE finished.
    Step 89000, Episode Steps: 800, Avg Reward: -4.867, Episode Reward: -3893.5
    检测进度: 0/24 (0.0%), Episode total: 0
    智能体位置: [('usv_0', '(290,3148)'), ('usv_1', '(259,4128)'), ('usv_2', '(282,5162)')]...
    Recent rewards sample: {'usv_0': np.float64(0.29108204313946073), 'usv_1': np.float64(-0.6302011687756914)}
    Episode time: 80.0s, Time penalty=-0.15
------------------------------------------------------------
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [0.24132241 0.25390735] (agent usv_0)
    MADDPG UPDATING at time_step 90000...
    MADDPG UPDATE finished.
    Step 90000, Episode Steps: 1800, Avg Reward: 5.692, Episode Reward: 10245.9
    检测进度: 4/41 (9.8%), Episode total: 4
    智能体位置: [('usv_0', '(307,3260)'), ('usv_1', '(281,4091)'), ('usv_2', '(319,5248)')]...
    Recent rewards sample: {'usv_0': np.float64(2.2755791095664555), 'usv_1': np.float64(1.375978461945671)}
    Episode time: 180.0s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 91000...
    MADDPG UPDATE finished.
    Step 91000, Episode Steps: 2800, Avg Reward: 8.266, Episode Reward: 23145.8
    检测进度: 5/66 (7.6%), Episode total: 5
    智能体位置: [('usv_0', '(215,3312)'), ('usv_1', '(300,4045)'), ('usv_2', '(281,5317)')]...
    Recent rewards sample: {'usv_0': np.float64(-7.755228830741139), 'usv_1': np.float64(1.3738400528259653)}
    Episode time: 280.0s, Time penalty=-0.15
------------------------------------------------------------
Episode 34 Summary:
  Total Reward: 23507.0
  Targets Detected: 6/70 (7.1%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 7.83
--- Episode 35 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 92000...
    MADDPG UPDATE finished.
    Step 92000, Episode Steps: 799, Avg Reward: 23.208, Episode Reward: 18543.0
    检测进度: 4/26 (15.4%), Episode total: 5
    智能体位置: [('usv_0', '(303,3142)'), ('usv_1', '(237,4117)'), ('usv_2', '(242,5195)')]...
    Recent rewards sample: {'usv_0': np.float64(4.287335389073724), 'usv_1': np.float64(3.3701217353822708)}
    Episode time: 79.9s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 93000...
    MADDPG UPDATE finished.
    Step 93000, Episode Steps: 1799, Avg Reward: 22.565, Episode Reward: 40594.1
    检测进度: 6/52 (11.5%), Episode total: 8
    智能体位置: [('usv_0', '(413,3175)'), ('usv_1', '(244,4074)'), ('usv_2', '(208,5265)')]...
    Recent rewards sample: {'usv_0': np.float64(4.312770913121577), 'usv_1': np.float64(3.3723499108749078)}
    Episode time: 179.9s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 94000...
    MADDPG UPDATE finished.
    Step 94000, Episode Steps: 2799, Avg Reward: 22.727, Episode Reward: 63611.8
    检测进度: 8/78 (10.3%), Episode total: 12
    智能体位置: [('usv_0', '(496,3226)'), ('usv_1', '(209,4047)'), ('usv_2', '(206,5226)')]...
    Recent rewards sample: {'usv_0': np.float64(4.328798364971512), 'usv_1': np.float64(3.3711591216745926)}
    Episode time: 279.9s, Time penalty=-0.15
------------------------------------------------------------
Episode 35 Summary:
  Total Reward: 68081.0
  Targets Detected: 12/83 (9.6%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 22.69
--- Episode 36 ---
分配了6个智能体的专责区域
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [0.04240434 0.0139312 ] (agent usv_0)
    MADDPG UPDATING at time_step 95000...
    MADDPG UPDATE finished.
    Step 95000, Episode Steps: 798, Avg Reward: 0.937, Episode Reward: 747.7
    检测进度: 1/26 (3.8%), Episode total: 1
    智能体位置: [('usv_0', '(311,3148)'), ('usv_1', '(240,4122)'), ('usv_2', '(263,5189)')]...
    Recent rewards sample: {'usv_0': np.float64(2.286522622738004), 'usv_1': np.float64(1.3683543338977762)}
    Episode time: 79.8s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 96000...
    MADDPG UPDATE finished.
    Step 96000, Episode Steps: 1798, Avg Reward: 12.579, Episode Reward: 22616.3
    检测进度: 4/55 (7.3%), Episode total: 5
    智能体位置: [('usv_0', '(401,3197)'), ('usv_1', '(269,4076)'), ('usv_2', '(289,5311)')]...
    Recent rewards sample: {'usv_0': np.float64(2.3014765000682846), 'usv_1': np.float64(3.370914743063044)}
    Episode time: 179.8s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 97000...
    MADDPG UPDATE finished.
    Step 97000, Episode Steps: 2798, Avg Reward: 10.256, Episode Reward: 28695.9
    检测进度: 8/65 (12.3%), Episode total: 9
    智能体位置: [('usv_0', '(509,3273)'), ('usv_1', '(265,4041)'), ('usv_2', '(214,5357)')]...
    Recent rewards sample: {'usv_0': np.float64(2.334482359348501), 'usv_1': np.float64(1.3753319124936718)}
    Episode time: 279.8s, Time penalty=-0.15
------------------------------------------------------------
Episode 36 Summary:
  Total Reward: 28834.0
  Targets Detected: 11/75 (13.3%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 9.61
--- Episode 37 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 98000...
    MADDPG UPDATE finished.
    Step 98000, Episode Steps: 797, Avg Reward: 14.391, Episode Reward: 11469.9
    检测进度: 4/21 (19.0%), Episode total: 4
    智能体位置: [('usv_0', '(295,3158)'), ('usv_1', '(247,4121)'), ('usv_2', '(279,5124)')]...
    Recent rewards sample: {'usv_0': np.float64(2.281131647176422), 'usv_1': np.float64(3.3713271968791165)}
    Episode time: 79.7s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 99000...
    MADDPG UPDATE finished.
    Step 99000, Episode Steps: 1797, Avg Reward: 14.048, Episode Reward: 25244.2
    检测进度: 5/54 (9.3%), Episode total: 6
    智能体位置: [('usv_0', '(322,3262)'), ('usv_1', '(271,4099)'), ('usv_2', '(366,5149)')]...
    Recent rewards sample: {'usv_0': np.float64(-5.725333193234143), 'usv_1': np.float64(3.3733210365123423)}
    Episode time: 179.7s, Time penalty=-0.15
------------------------------------------------------------
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [ 0.15604522 -0.19107558] (agent usv_0)
    MADDPG UPDATING at time_step 100000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 100000, Episode Steps: 2797, Avg Reward: 10.127, Episode Reward: 28325.7
    检测进度: 7/77 (9.1%), Episode total: 9
    智能体位置: [('usv_0', '(250,3321)'), ('usv_1', '(241,4043)'), ('usv_2', '(355,5244)')]...
    Recent rewards sample: {'usv_0': np.float64(-5.7399289416336625), 'usv_1': np.float64(3.3695322573925353)}
    Episode time: 279.7s, Time penalty=-0.15
------------------------------------------------------------
Episode 37 Summary:
  Total Reward: 29060.3
  Targets Detected: 10/81 (9.9%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 9.68
--- Episode 38 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 101000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 101000, Episode Steps: 796, Avg Reward: 2.632, Episode Reward: 2094.9
    检测进度: 1/18 (5.6%), Episode total: 1
    智能体位置: [('usv_0', '(305,3136)'), ('usv_1', '(249,4114)'), ('usv_2', '(271,5177)')]...
    Recent rewards sample: {'usv_0': np.float64(0.297688084725643), 'usv_1': np.float64(1.3747901548519876)}
    Episode time: 79.6s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 102000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 102000, Episode Steps: 1796, Avg Reward: 9.824, Episode Reward: 17643.5
    检测进度: 5/55 (9.1%), Episode total: 5
    智能体位置: [('usv_0', '(399,3191)'), ('usv_1', '(293,4099)'), ('usv_2', '(280,5277)')]...
    Recent rewards sample: {'usv_0': np.float64(2.307007124863776), 'usv_1': np.float64(3.372516784617897)}
    Episode time: 179.6s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 103000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 103000, Episode Steps: 2796, Avg Reward: 14.140, Episode Reward: 39534.8
    检测进度: 8/79 (10.1%), Episode total: 8
    智能体位置: [('usv_0', '(443,3279)'), ('usv_1', '(323,4062)'), ('usv_2', '(211,5358)')]...
    Recent rewards sample: {'usv_0': np.float64(4.302838226143044), 'usv_1': np.float64(3.377179964518576)}
    Episode time: 279.6s, Time penalty=-0.15
------------------------------------------------------------
Episode 38 Summary:
  Total Reward: 45536.7
  Targets Detected: 9/84 (10.7%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 15.17
--- Episode 39 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 104000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 104000, Episode Steps: 795, Avg Reward: 15.700, Episode Reward: 12481.8
    检测进度: 4/28 (14.3%), Episode total: 4
    智能体位置: [('usv_0', '(294,3146)'), ('usv_1', '(243,4137)'), ('usv_2', '(265,5175)')]...
    Recent rewards sample: {'usv_0': np.float64(4.282379689167014), 'usv_1': np.float64(3.3685623817090686)}
    Episode time: 79.5s, Time penalty=-0.15
------------------------------------------------------------
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [0.19262965 0.13798709] (agent usv_0)
    MADDPG UPDATING at time_step 105000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 105000, Episode Steps: 1795, Avg Reward: 17.613, Episode Reward: 31615.6
    检测进度: 7/50 (14.0%), Episode total: 7
    智能体位置: [('usv_0', '(400,3176)'), ('usv_1', '(277,4149)'), ('usv_2', '(248,5267)')]...
    Recent rewards sample: {'usv_0': np.float64(4.314489878681932), 'usv_1': np.float64(3.3772651766031805)}
    Episode time: 179.5s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 106000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 106000, Episode Steps: 2795, Avg Reward: 20.300, Episode Reward: 56738.9
    检测进度: 12/72 (16.7%), Episode total: 13
    智能体位置: [('usv_0', '(471,3229)'), ('usv_1', '(329,4140)'), ('usv_2', '(204,5254)')]...
    Recent rewards sample: {'usv_0': np.float64(4.314550252740149), 'usv_1': np.float64(3.37570566179531)}
    Episode time: 279.5s, Time penalty=-0.15
------------------------------------------------------------
Episode 39 Summary:
  Total Reward: 61288.4
  Targets Detected: 13/77 (15.6%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 20.42
--- Episode 40 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 107000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 107000, Episode Steps: 794, Avg Reward: 15.559, Episode Reward: 12353.8
    检测进度: 4/28 (14.3%), Episode total: 4
    智能体位置: [('usv_0', '(308,3143)'), ('usv_1', '(236,4130)'), ('usv_2', '(292,5154)')]...
    Recent rewards sample: {'usv_0': np.float64(2.286514006342184), 'usv_1': np.float64(3.3680577267068372)}
    Episode time: 79.4s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 108000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 108000, Episode Steps: 1794, Avg Reward: 17.877, Episode Reward: 32071.1
    检测进度: 6/59 (10.2%), Episode total: 8
    智能体位置: [('usv_0', '(375,3224)'), ('usv_1', '(256,4098)'), ('usv_2', '(308,5237)')]...
    Recent rewards sample: {'usv_0': np.float64(4.293811909220453), 'usv_1': np.float64(1.3699371594816223)}
    Episode time: 179.4s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 109000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 109000, Episode Steps: 2794, Avg Reward: 14.221, Episode Reward: 39734.7
    检测进度: 7/86 (8.1%), Episode total: 10
    智能体位置: [('usv_0', '(399,3328)'), ('usv_1', '(267,4055)'), ('usv_2', '(254,5201)')]...
    Recent rewards sample: {'usv_0': np.float64(4.286695387169448), 'usv_1': np.float64(1.37290033179504)}
    Episode time: 279.4s, Time penalty=-0.15
------------------------------------------------------------
Episode 40 Summary:
  Total Reward: 40494.5
  Targets Detected: 10/88 (8.0%)
  Steps: 2836
  Episode Time: 283.6s
  Termination Reason: no_progress_120s
  Average Reward/Step: 14.28

==================================================
MADDPG TRAINING PROGRESS - Episode 40
==================================================
Last 10 episodes average reward: 33406.5
Last 10 episodes average detections: 10.1
Best episode reward so far: 68081.0
Best detection count so far: 15
Learning trend: Improving (33406.5 vs 28216.4)
Buffer size: 50000
==================================================

--- Episode 41 ---
分配了6个智能体的专责区域
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [ 0.01462644 -0.21857241] (agent usv_0)
    MADDPG UPDATING at time_step 110000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 110000, Episode Steps: 958, Avg Reward: 10.326, Episode Reward: 9892.7
    检测进度: 4/40 (10.0%), Episode total: 4
    智能体位置: [('usv_0', '(326,3157)'), ('usv_1', '(247,4112)'), ('usv_2', '(258,5188)')]...
    Recent rewards sample: {'usv_0': np.float64(4.289016467456663), 'usv_1': np.float64(1.3714747421027993)}
    Episode time: 95.8s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 111000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 111000, Episode Steps: 1958, Avg Reward: 14.961, Episode Reward: 29293.2
    检测进度: 7/69 (10.1%), Episode total: 7
    智能体位置: [('usv_0', '(420,3201)'), ('usv_1', '(243,4066)'), ('usv_2', '(211,5238)')]...
    Recent rewards sample: {'usv_0': np.float64(4.305832605789467), 'usv_1': np.float64(1.3691730128080222)}
    Episode time: 195.8s, Time penalty=-0.15
------------------------------------------------------------
Episode 41 Summary:
  Total Reward: 37462.5
  Targets Detected: 8/76 (9.2%)
  Steps: 2450
  Episode Time: 245.0s
  Termination Reason: no_progress_120s
  Average Reward/Step: 15.29
--- Episode 42 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 112000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 112000, Episode Steps: 508, Avg Reward: -3.684, Episode Reward: -1871.5
    检测进度: 0/11 (0.0%), Episode total: 0
    智能体位置: [('usv_0', '(254,3121)'), ('usv_1', '(235,4120)'), ('usv_2', '(262,5139)')]...
    Recent rewards sample: {'usv_0': np.float64(2.283792225880004), 'usv_1': np.float64(-0.6295566095443024)}
    Episode time: 50.8s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 113000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 113000, Episode Steps: 1508, Avg Reward: 9.725, Episode Reward: 14665.9
    检测进度: 6/42 (14.3%), Episode total: 7
    智能体位置: [('usv_0', '(376,3125)'), ('usv_1', '(239,4072)'), ('usv_2', '(314,5216)')]...
    Recent rewards sample: {'usv_0': np.float64(4.324183820553205), 'usv_1': np.float64(1.371432705082471)}
    Episode time: 150.8s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 114000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 114000, Episode Steps: 2508, Avg Reward: 14.743, Episode Reward: 36974.6
    检测进度: 9/72 (12.5%), Episode total: 10
    智能体位置: [('usv_0', '(453,3196)'), ('usv_1', '(229,4032)'), ('usv_2', '(258,5279)')]...
    Recent rewards sample: {'usv_0': np.float64(4.314615681432136), 'usv_1': np.float64(3.3689902096280537)}
    Episode time: 250.8s, Time penalty=-0.15
------------------------------------------------------------
Episode 42 Summary:
  Total Reward: 45863.8
  Targets Detected: 10/82 (9.8%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 15.28
--- Episode 43 ---
分配了6个智能体的专责区域
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [-0.11569558 -0.04905183] (agent usv_0)
    MADDPG UPDATING at time_step 115000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 115000, Episode Steps: 507, Avg Reward: -3.551, Episode Reward: -1800.2
    检测进度: 1/23 (4.3%), Episode total: 1
    智能体位置: [('usv_0', '(280,3137)'), ('usv_1', '(232,4122)'), ('usv_2', '(261,5139)')]...
    Recent rewards sample: {'usv_0': np.float64(0.27938812643347766), 'usv_1': np.float64(-0.6312395095853796)}
    Episode time: 50.7s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 116000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 116000, Episode Steps: 1507, Avg Reward: 2.748, Episode Reward: 4140.8
    检测进度: 3/43 (7.0%), Episode total: 4
    智能体位置: [('usv_0', '(365,3197)'), ('usv_1', '(262,4088)'), ('usv_2', '(306,5212)')]...
    Recent rewards sample: {'usv_0': np.float64(1.3000104315999486), 'usv_1': np.float64(0.3731429185763928)}
    Episode time: 150.7s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 117000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 117000, Episode Steps: 2507, Avg Reward: 7.287, Episode Reward: 18269.0
    检测进度: 3/61 (4.9%), Episode total: 4
    智能体位置: [('usv_0', '(441,3280)'), ('usv_1', '(235,4065)'), ('usv_2', '(246,5287)')]...
    Recent rewards sample: {'usv_0': np.float64(2.3053388480810577), 'usv_1': np.float64(3.376055326903277)}
    Episode time: 250.7s, Time penalty=-0.15
------------------------------------------------------------
Episode 43 Summary:
  Total Reward: 19058.7
  Targets Detected: 4/61 (4.9%)
  Steps: 2556
  Episode Time: 255.6s
  Termination Reason: no_progress_120s
  Average Reward/Step: 7.46
--- Episode 44 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 118000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 118000, Episode Steps: 951, Avg Reward: 4.618, Episode Reward: 4391.5
    检测进度: 4/40 (10.0%), Episode total: 4
    智能体位置: [('usv_0', '(297,3151)'), ('usv_1', '(259,4125)'), ('usv_2', '(293,5152)')]...
    Recent rewards sample: {'usv_0': np.float64(2.288470974010611), 'usv_1': np.float64(1.3707055216802044)}
    Episode time: 95.1s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 119000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 119000, Episode Steps: 1951, Avg Reward: 12.408, Episode Reward: 24207.2
    检测进度: 6/68 (8.8%), Episode total: 8
    智能体位置: [('usv_0', '(313,3252)'), ('usv_1', '(296,4114)'), ('usv_2', '(276,5215)')]...
    Recent rewards sample: {'usv_0': np.float64(2.27763192317592), 'usv_1': np.float64(1.3745557162224475)}
    Episode time: 195.1s, Time penalty=-0.15
------------------------------------------------------------
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [ 0.34813151 -0.23510676] (agent usv_0)
    MADDPG UPDATING at time_step 120000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 120000, Episode Steps: 2951, Avg Reward: 15.155, Episode Reward: 44723.2
    检测进度: 8/105 (7.6%), Episode total: 13
    智能体位置: [('usv_0', '(289,3343)'), ('usv_1', '(303,4071)'), ('usv_2', '(203,5210)')]...
    Recent rewards sample: {'usv_0': np.float64(2.268743095181822), 'usv_1': np.float64(1.3744840870750403)}
    Episode time: 295.1s, Time penalty=-0.15
------------------------------------------------------------
Episode 44 Summary:
  Total Reward: 45522.2
  Targets Detected: 13/107 (7.5%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 15.17
--- Episode 45 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 121000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 121000, Episode Steps: 950, Avg Reward: -1.341, Episode Reward: -1274.0
    检测进度: 1/43 (2.3%), Episode total: 2
    智能体位置: [('usv_0', '(313,3135)'), ('usv_1', '(261,4126)'), ('usv_2', '(296,5162)')]...
    Recent rewards sample: {'usv_0': np.float64(1.2880809168003375), 'usv_1': np.float64(2.3699319167849504)}
    Episode time: 95.0s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 122000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 122000, Episode Steps: 1950, Avg Reward: 9.048, Episode Reward: 17642.7
    检测进度: 5/78 (6.4%), Episode total: 6
    智能体位置: [('usv_0', '(430,3159)'), ('usv_1', '(282,4090)'), ('usv_2', '(280,5281)')]...
    Recent rewards sample: {'usv_0': np.float64(2.319038787107205), 'usv_1': np.float64(1.3754392868673242)}
    Episode time: 195.0s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 123000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 123000, Episode Steps: 2950, Avg Reward: 13.369, Episode Reward: 39437.4
    检测进度: 8/106 (7.5%), Episode total: 11
    智能体位置: [('usv_0', '(486,3238)'), ('usv_1', '(271,4042)'), ('usv_2', '(221,5332)')]...
    Recent rewards sample: {'usv_0': np.float64(4.321410824659071), 'usv_1': np.float64(1.3763203374091604)}
    Episode time: 295.0s, Time penalty=-0.15
------------------------------------------------------------
Episode 45 Summary:
  Total Reward: 41122.1
  Targets Detected: 12/106 (8.5%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 13.70
--- Episode 46 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 124000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 124000, Episode Steps: 949, Avg Reward: -2.935, Episode Reward: -2785.7
    检测进度: 1/31 (3.2%), Episode total: 1
    智能体位置: [('usv_0', '(329,3133)'), ('usv_1', '(244,4103)'), ('usv_2', '(264,5159)')]...
    Recent rewards sample: {'usv_0': np.float64(0.2953583172309151), 'usv_1': np.float64(-0.63121491006918)}
    Episode time: 94.9s, Time penalty=-0.15
------------------------------------------------------------
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [-0.0080191   0.07757458] (agent usv_0)
    MADDPG UPDATING at time_step 125000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 125000, Episode Steps: 1949, Avg Reward: 6.001, Episode Reward: 11696.9
    检测进度: 4/54 (7.4%), Episode total: 4
    智能体位置: [('usv_0', '(448,3142)'), ('usv_1', '(254,4042)'), ('usv_2', '(229,5254)')]...
    Recent rewards sample: {'usv_0': np.float64(2.3244428229889094), 'usv_1': np.float64(3.3715450952204904)}
    Episode time: 194.9s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 126000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 126000, Episode Steps: 2949, Avg Reward: 9.832, Episode Reward: 28995.6
    检测进度: 4/78 (5.1%), Episode total: 6
    智能体位置: [('usv_0', '(534,3190)'), ('usv_1', '(218,4026)'), ('usv_2', '(209,5217)')]...
    Recent rewards sample: {'usv_0': np.float64(4.338358280587281), 'usv_1': np.float64(3.3743918342429158)}
    Episode time: 294.9s, Time penalty=-0.15
------------------------------------------------------------
Episode 46 Summary:
  Total Reward: 30044.7
  Targets Detected: 6/81 (4.9%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 10.01
--- Episode 47 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 127000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 127000, Episode Steps: 948, Avg Reward: 9.240, Episode Reward: 8759.8
    检测进度: 3/33 (9.1%), Episode total: 3
    智能体位置: [('usv_0', '(310,3188)'), ('usv_1', '(251,4093)'), ('usv_2', '(286,5169)')]...
    Recent rewards sample: {'usv_0': np.float64(3.2829265050529095), 'usv_1': np.float64(2.3777915704562997)}
    Episode time: 94.8s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 128000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 128000, Episode Steps: 1948, Avg Reward: 13.009, Episode Reward: 25342.3
    检测进度: 6/61 (9.8%), Episode total: 6
    智能体位置: [('usv_0', '(363,3279)'), ('usv_1', '(245,4049)'), ('usv_2', '(233,5234)')]...
    Recent rewards sample: {'usv_0': np.float64(-5.7078740263198), 'usv_1': np.float64(1.3757602173477372)}
    Episode time: 194.8s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 129000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 129000, Episode Steps: 2948, Avg Reward: 11.471, Episode Reward: 33815.2
    检测进度: 5/85 (5.9%), Episode total: 6
    智能体位置: [('usv_0', '(366,3381)'), ('usv_1', '(207,4024)'), ('usv_2', '(209,5238)')]...
    Recent rewards sample: {'usv_0': np.float64(4.2756667276455556), 'usv_1': np.float64(3.3729831034850912)}
    Episode time: 294.8s, Time penalty=-0.15
------------------------------------------------------------
Episode 47 Summary:
  Total Reward: 34867.8
  Targets Detected: 6/86 (5.8%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 11.62
--- Episode 48 ---
分配了6个智能体的专责区域
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [ 0.15408556 -0.09832789] (agent usv_0)
    MADDPG UPDATING at time_step 130000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 130000, Episode Steps: 947, Avg Reward: 6.564, Episode Reward: 6216.4
    检测进度: 4/31 (12.9%), Episode total: 4
    智能体位置: [('usv_0', '(305,3153)'), ('usv_1', '(255,4119)'), ('usv_2', '(297,5167)')]...
    Recent rewards sample: {'usv_0': np.float64(2.291222092670169), 'usv_1': np.float64(3.370678862400222)}
    Episode time: 94.7s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 131000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 131000, Episode Steps: 1947, Avg Reward: 15.282, Episode Reward: 29753.1
    检测进度: 9/57 (15.8%), Episode total: 10
    智能体位置: [('usv_0', '(380,3216)'), ('usv_1', '(279,4081)'), ('usv_2', '(323,5271)')]...
    Recent rewards sample: {'usv_0': np.float64(4.297800116936871), 'usv_1': np.float64(3.371593278827583)}
    Episode time: 194.7s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 132000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 132000, Episode Steps: 2947, Avg Reward: 16.923, Episode Reward: 49872.5
    检测进度: 9/75 (12.0%), Episode total: 11
    智能体位置: [('usv_0', '(405,3332)'), ('usv_1', '(274,4029)'), ('usv_2', '(214,5271)')]...
    Recent rewards sample: {'usv_0': np.float64(2.2963944839440296), 'usv_1': np.float64(3.3722996120396864)}
    Episode time: 294.7s, Time penalty=-0.15
------------------------------------------------------------
Episode 48 Summary:
  Total Reward: 50956.6
  Targets Detected: 11/75 (12.0%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 16.98
--- Episode 49 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 133000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 133000, Episode Steps: 946, Avg Reward: 13.075, Episode Reward: 12369.0
    检测进度: 3/20 (15.0%), Episode total: 3
    智能体位置: [('usv_0', '(303,3159)'), ('usv_1', '(252,4104)'), ('usv_2', '(270,5171)')]...
    Recent rewards sample: {'usv_0': np.float64(4.2897919994697915), 'usv_1': np.float64(1.3756525129721329)}
    Episode time: 94.6s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 134000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 134000, Episode Steps: 1946, Avg Reward: 16.998, Episode Reward: 33078.4
    检测进度: 4/60 (6.7%), Episode total: 5
    智能体位置: [('usv_0', '(396,3235)'), ('usv_1', '(285,4083)'), ('usv_2', '(285,5273)')]...
    Recent rewards sample: {'usv_0': np.float64(4.295249060427112), 'usv_1': np.float64(1.3730271293214389)}
    Episode time: 194.6s, Time penalty=-0.15
------------------------------------------------------------
    DEBUG: MADDPG actions shape = (6, 2)
    DEBUG: Sample action = [ 0.26069476 -0.14935173] (agent usv_0)
    MADDPG UPDATING at time_step 135000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 135000, Episode Steps: 2946, Avg Reward: 18.830, Episode Reward: 55471.9
    检测进度: 7/93 (7.5%), Episode total: 8
    智能体位置: [('usv_0', '(451,3338)'), ('usv_1', '(305,4044)'), ('usv_2', '(228,5343)')]...
    Recent rewards sample: {'usv_0': np.float64(4.302146585271618), 'usv_1': np.float64(3.3742127734018394)}
    Episode time: 294.6s, Time penalty=-0.15
------------------------------------------------------------
Episode 49 Summary:
  Total Reward: 56445.5
  Targets Detected: 8/96 (7.3%)
  Steps: 3001
  Episode Time: 300.1s
  Termination Reason: time_limit_300s
  Average Reward/Step: 18.81
--- Episode 50 ---
分配了6个智能体的专责区域
    MADDPG UPDATING at time_step 136000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 136000, Episode Steps: 945, Avg Reward: 9.234, Episode Reward: 8726.2
    检测进度: 5/38 (13.2%), Episode total: 5
    智能体位置: [('usv_0', '(320,3156)'), ('usv_1', '(253,4140)'), ('usv_2', '(299,5160)')]...
    Recent rewards sample: {'usv_0': np.float64(4.29179920060191), 'usv_1': np.float64(1.369308279900396)}
    Episode time: 94.5s, Time penalty=-0.15
------------------------------------------------------------
    MADDPG UPDATING at time_step 137000...
    MADDPG UPDATE finished.
    Avg Actor Loss: 0.0190, Avg Critic Loss: 201.4762
    Step 137000, Episode Steps: 1945, Avg Reward: 14.084, Episode Reward: 27392.7
    检测进度: 6/61 (9.8%), Episode total: 8
    智能体位置: [('usv_0', '(415,3221)'), ('usv_1', '(294,4124)'), ('usv_2', '(309,5261)')]...
    Recent rewards sample: {'usv_0': np.float64(4.31236854433731), 'usv_1': np.float64(1.3724309050541788)}
    Episode time: 194.5s, Time penalty=-0.15
------------------------------------------------------------
Episode 50 Summary:
  Total Reward: 40983.4
  Targets Detected: 10/73 (9.6%)
  Steps: 2626
  Episode Time: 262.6s
  Termination Reason: no_progress_120s
  Average Reward/Step: 15.61

==================================================
MADDPG TRAINING PROGRESS - Episode 50
==================================================
Last 10 episodes average reward: 40232.7
Last 10 episodes average detections: 8.8
Best episode reward so far: 68081.0
Best detection count so far: 15
Learning trend: Improving (40232.7 vs 33406.5)
Buffer size: 50000
==================================================


=====================TRAINING COMPLETED=====================
Total episodes: 50
Best episode reward: 68081.0
Final 10 episodes average: 40232.7
Best detection performance: 15 targets
Average detections (final 10): 8.8
============================================================
{"final_avg_reward": 40232.71059617382, "final_detection_rate": 8.8, "best_episode_reward": 68081.02332444064, "best_detection_count": 15, "total_episodes": 50}
Simulation finished.
